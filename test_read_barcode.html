<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Barcode Scanner</title>
    <script src="https://unpkg.com/@ericblade/quagga2/dist/quagga.min.js"></script>
  </head>
  <body>
    <h2>ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒŠ</h2>
    <button id="start-btn">ğŸ“· ã‚«ãƒ¡ãƒ©ã‚’èµ·å‹•</button>
    <div id="scanner" style="width: 300px; height: 200px; margin-top: 10px;"></div>
    <p id="result">èª­ã¿å–ã‚Šä¸­...</p>

    <script>
      document.getElementById("start-btn").addEventListener("click", function () {
        Quagga.init({
          inputStream: {
            type: "LiveStream",
            target: document.querySelector('#scanner'),
            constraints: {
              facingMode: { ideal: "environment" },
              width: { ideal: 320 },  // è»½é‡åŒ–
              height: { ideal: 240 }
            }
          },
          decoder: {
            readers: ["code_128_reader"],  // ã‚·ãƒ³ãƒ—ãƒ«ã«1ç¨®é¡ã®ã¿
          }
        }, function(err) {
          if (err) {
            console.error("Quagga init error:", err);
            document.getElementById("result").textContent =
              "ã‚«ãƒ¡ãƒ©åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼: " + err;
            alert("ã‚«ãƒ¡ãƒ©åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ: " + err);
            return;
          }
          console.log("Initialization finished. Ready to start");
          Quagga.start();

          Quagga.onDetected(function(result) {
            const code = result.codeResult.code;
            alert("ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’æ¤œå‡ºã—ã¾ã—ãŸ: " + code);
            document.getElementById("result").textContent = "èª­ã¿å–ã‚Š: " + code;
          });
        });
      });
    </script>
  </body>
</html>
