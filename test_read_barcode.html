<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Barcode Scanner</title>
    <script src="https://unpkg.com/@ericblade/quagga2/dist/quagga.min.js"></script>
  </head>
  <body>
    <h2>バーコードスキャナ</h2>
    <div id="scanner" style="width: 300px; height: 200px;"></div>
    <p id="result">読み取り中...</p>

    <script>
      const SHEET_URL = "＜GASのURLをここに貼る＞";

      Quagga.init({
        inputStream: {
          name: "Live",
          type: "LiveStream",
          target: document.querySelector('#scanner'),
          constraints: {
            facingMode: "environment"
          }
        },
        decoder: {
          readers: ["ean_reader", "code_128_reader", "qr_reader"]
        }
      }, err => {
        if (err) { console.error(err); return; }
        Quagga.start();
      });

      Quagga.onDetected(data => {
        const code = data.codeResult.code;
        document.getElementById("result").textContent = "読み取り: " + code;

        fetch(SHEET_URL, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ barcode: code })
        });

        Quagga.stop(); // 1回読み取ったら停止
      });
    </script>
  </body>
</html>

